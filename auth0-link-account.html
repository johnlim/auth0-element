<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="auth0.html">

<dom-module id="auth0-link-account">

  <template>
  </template>

  <script>
    Polymer({

      is: 'auth0-link-account',

      properties: {
        connection: {
          type: String,
          notify: true
        },
        clientId: {
          type: String
        },
        domain: {
          type: String
        },
        options: {
          type: Object
        }
      },

      observers: [
        '_initAccountLinking(connection)'
      ],

      _initAccountLinking: function(connection) {
        if(!connection) return;
        localStorage.setItem('auth0:link-account', connection);

        var webAuth = new auth0.WebAuth({
          domain: this.domain,
          clientID: this.clientId
        });

        var options = Object.assign({}, this.options, {connection: this.connection});

        webAuth.authorize(options);
      }
    });

  </script>
</dom-module>
